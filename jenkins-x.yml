buildPack: maven-quarkus
pipelineConfig:
  agent:
    image: maven-java11
  pipelines:
    overrides:
      - pipeline: release
        stage: build
        name: mvn-deploy
        containerOptions:
          env:
            - name: _JAVA_OPTIONS
              value: >-
                -XX:+UnlockExperimentalVMOptions -XX:+UseJVMCICompiler
                -XX:MinRAMPercentage=50 -XX:MaxRAMPercentage=70
                -Xms122880m -Xmx163840m -Xss10m
          resources:
            requests:
              cpu: "2"
              memory: 20Gi
            limits:
              cpu: "2"
              memory: 20Gi
        steps:
          - name: mvn-deploy
            command: mvn -Pnative clean package -e --show-version -Dquarkus.native.native-image-xmx=163840m -Dnative-image.xmx=16g
            image: caladreas/builder-maven-graalvm-java11:0.0.3
            env:
              - name: _JAVA_OPTIONS
                value: >-
                    -XX:+UnlockExperimentalVMOptions -XX:+UseJVMCICompiler
                    -XX:MinRAMPercentage=50 -XX:MaxRAMPercentage=70
                    -Xms122880m -Xmx163840m -Xss10m


